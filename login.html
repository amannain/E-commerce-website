<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css" />
    <script src="jquery/jquery-3.5.1.min.js"></script>
    <title>E-commerce Login</title>
</head>

<body>
    <ul>
        <li><span>E-commerce</span></li>
        <li><a href="register.html">Register</a></li>
        <li><a href="login.html">login</a></li>
    </ul>
    <form class='formLogin'>
        <div class="container" style='width:400px;'>
            <h2>Login</h2>
            <hr>
            <input type="email" placeholder="Enter Email" name="email" id="email" required>
            <input type="password" placeholder="Enter Password" name="password" id="password" required>
            <button type="submit" id="loginBtn">Register</button>
        </div>
    </form>
</body>

</html>
<script>
    $(document).ready(function () {
        $('.formLogin').submit(function (event) {
            event.preventDefault();
            var emailID = $('#email').val();
            var passValue = $('#password').val();
            //validating
            if (emailID == '' || passValue == '') {
                alert("Please fill all the fields!")
                return false;
            }
            else {

                const urlLink = 'http://localhost:3000/userLogin'
                $.ajax({
                    type: 'post', url: urlLink,
                    data: {
                        email: emailID,
                        pass: passValue,
                    },
                    success: function (data, status) {
                        var currentUser = data.result;
                        alert("Data: " + data.result.name + " logged In successfully" + "\nStatus: " + status)
                        sessionStorage.setItem("currentUser", JSON.stringify(currentUser));
                        // Retrieve
                        console.log(JSON.parse(sessionStorage.getItem("currentUser")));
                    },
                    error: function (xhr, status) {
                        if (xhr.status === 404) {
                            alert("Result: " + xhr.responseJSON.result + "\nStatus: " + status);
                            location.reload()
                        }
                        else {
                            alert("Result: " + xhr.responseJSON.result + "\nStatus: " + status)
                            location.reload();
                        }
                    }
                })
            }

        })
    })
</script>